<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="color-scheme" content="dark light" />
  <title>Macro Risk Monitor</title>
  <link rel="stylesheet" href="./assets/style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body data-page="home">
  <div class="wrap">

    <!-- ✅ 顶部导航：从首页进入宏观/总览/专题页 -->
    <div class="nav">
      <div class="brand">Fairt · 投研自动化</div>
      <div class="tabs">
        <a class="tab active" href="./index.html">首页</a>
        <a class="tab" href="./dashboard.html">总览</a>
        <a class="tab" href="./macro.html">宏观</a>
        <a class="tab" href="./ashares.html">A股</a>
        <a class="tab" href="./copper.html">铜</a>
        <a class="tab" href="./method.html">方法</a>
        <a class="tab" href="./changelog.html">更新</a>
        <a class="tab" href="./about.html">关于</a>
      </div>
    </div>

    <header class="top">
      <div class="brand">
        <div class="title">Macro Risk Monitor</div>
        <div class="meta">
          <span class="pill mono" id="asOf">—</span>
          <span class="dot">•</span>
          <span class="muted" id="mode">LATEST</span>
          <span class="dot">•</span>
          <span class="badge"><span class="b-dot"></span><span>deterministic + archive</span></span>
        </div>
      </div>

      <div class="right">
        <div class="kpis">
          <div class="kpi">
            <div class="kpi-label">Risk Score</div>
            <div class="kpi-value mono" id="riskScore">—</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">1D Δ</div>
            <div class="kpi-value mono" id="delta1d">—</div>
          </div>
          <div class="kpi">
            <div class="kpi-label">Regime</div>
            <div class="kpi-value mono" id="regime">—</div>
          </div>
        </div>

        <div class="actions">
          <button class="btn" id="btnLatest" title="R">Latest</button>
          <button class="btn" id="btnCompare" title="C">Compare</button>
          <button class="btn" id="btnShare">Share</button>
        </div>
      </div>
    </header>

    <section class="strip">
      <div class="strip-left">
        <div class="label">Risk trend (EMA)</div>
        <div class="spark" style="height:92px;">
          <canvas id="spark"></canvas>
        </div>
      </div>
      <div class="strip-right">
        <div class="label">Date / Proof</div>
        <div class="datebar">
          <input class="input mono" id="dateInput" placeholder="YYYY-MM-DD" inputmode="numeric" />
          <button class="btn" id="btnGo">Go</button>
          <div class="hint muted" id="dateHint">?date=YYYY-MM-DD</div>
        </div>
        <div class="sub muted mono" id="shareText">—</div>
      </div>
    </section>

    <main class="grid">
      <section class="card">
        <div class="card-hd">
          <div class="card-title">Mainline Theme</div>
          <div class="card-note muted">what dominates</div>
        </div>
        <div class="card-bd">
          <div class="big theme" id="theme">—</div>
          <div class="sub muted mono">interview narrative: explainable + reproducible</div>
        </div>
      </section>

      <section class="card">
        <div class="card-hd">
          <div class="card-title">Decision Hint</div>
          <div class="card-note muted">policy-like</div>
        </div>
        <div class="card-bd">
          <div class="big mono" id="riskLevel">—</div>
          <div class="sub" id="assetHint">—</div>
          <div class="sub muted mono">confidence: <span id="confidence">—</span></div>
        </div>
      </section>

      <section class="card">
        <div class="card-hd">
          <div class="card-title">Risk Gauge</div>
          <div class="card-note muted">0 → 100</div>
        </div>
        <div class="card-bd" style="height:180px;">
          <canvas id="gauge"></canvas>
        </div>
      </section>

      <section class="card">
        <div class="card-hd">
          <div class="card-title">Risk Factors</div>
          <div class="card-note muted">ranked</div>
        </div>
        <div class="card-bd">
          <div class="table" id="riskFactors"></div>
        </div>
      </section>

      <section class="card">
        <div class="card-hd">
          <div class="card-title">Factor Contributions</div>
          <div class="card-note muted">who pushes risk</div>
        </div>
        <div class="card-bd" style="height:220px;">
          <canvas id="contrib"></canvas>
        </div>
      </section>

      <section class="card">
        <div class="card-hd">
          <div class="card-title">Asset Bias</div>
          <div class="card-note muted">interpretation layer</div>
        </div>
        <div class="card-bd">
          <div class="table" id="assetBias"></div>
        </div>
      </section>

      <section class="card wide">
        <div class="card-hd">
          <div class="card-title">Regime Timeline</div>
          <div class="card-note muted mono">history → regime → archive</div>
        </div>
        <div class="card-bd">
          <div id="regimeTimeline"></div>
          <div class="sub muted">说明：每个格子代表一个交易日（近 50 天），用于快速看“制度切换”而不是看噪声。</div>
        </div>
      </section>

      <section class="card wide">
        <div class="card-hd">
          <div class="card-title">Factor Heatmap</div>
          <div class="card-note muted mono">shape matters</div>
        </div>
        <div class="card-bd">
          <div id="heatmap"></div>
        </div>
      </section>

      <section class="card" id="compareCard" data-hidden="true">
        <div class="card-hd">
          <div class="card-title">Compare</div>
          <div class="card-note muted" id="cmpMeta">—</div>
        </div>
        <div class="card-bd">
          <div class="cmp">
            <div class="row"><div class="k">Risk Score</div><div class="v mono" id="cmpRisk">—</div></div>
            <div class="row"><div class="k">1D Δ</div><div class="v mono" id="cmpDelta">—</div></div>
            <div class="row"><div class="k">Regime</div><div class="v mono" id="cmpRegime">—</div></div>
            <div class="row"><div class="k">Theme</div><div class="v" id="cmpTheme">—</div></div>
            <div class="hr"></div>
            <div class="row"><div class="k">Top factor change</div><div class="v mono" id="cmpTopFactor">—</div></div>
          </div>
        </div>
      </section>

      <section class="card wide">
        <div class="card-hd">
          <div class="card-title">Archive</div>
          <div class="card-note muted">snapshots</div>
        </div>
        <div class="card-bd">
          <div class="archive" id="archive"></div>
        </div>
      </section>
    </main>

    <footer class="foot muted">
      <span class="mono" id="status">—</span>
      <span class="dot">•</span>
      <a class="mono" href="./dashboard.html">dashboard</a>
      <span class="dot">•</span>
      <a class="mono" href="./method.html">method</a>
      <span class="dot">•</span>
      <a class="mono" href="./about.html">about</a>
    </footer>
  </div>

  <!-- ✅ 关键：JS 必须在这里引用，而不是粘贴进 HTML 里 -->
  <script src="./assets/app.js"></script>
</body>
</html>